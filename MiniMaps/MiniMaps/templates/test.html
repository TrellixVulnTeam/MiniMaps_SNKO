{% extends 'base.html' %}




{% block content %}
<script src="https://code.createjs.com/createjs-2015.11.26.min.js"></script>
<script>
    var stage, circle, rect, station, laststation, stationgraphics;
    var rectsize = 50;
    var counter = 0;
    var storage = [];
    stations = [];

    function init() {
        // Set stage
        counter = 0;
        stations = [];
        stage = new createjs.Stage("demoCanvas");
        
        // Set circle
        circle = new createjs.Shape();
        circle.graphics.beginFill("DeepSkyBlue")
            .drawCircle(0, 0, 5);
        circle.x = 100;
        circle.y = Math.floor(stage.canvas.width / 3);

        // Set station
        station = new createjs.Shape();
        station.graphics.beginFill("Grey")
            .drawRect(0,0,rectsize, rectsize);
        station.x = Math.floor(stage.canvas.width / 2);
        station.y = circle.y - 25;

        // Event ticker
        createjs.Ticker.addEventListener("tick", update);

        // Set ticker
        createjs.Ticker.setFPS(60);
        
        // Add objects to stage
        stage.addChild(circle);
        stage.addChild(station);

    }
    
    // within x pixels
    function within(x,y,z=10) {
        // x is within z of y
        if (Math.abs(x - y) < z) {
            return true;
        }
        return false;
    }

    // Fill the station
    function fillStation() {
        if (within(circle.x, station.x)) {
            station.scaleX = station.scaleX + .05;
            station.scaleY = station.scaleY + .05;
            station.y = station.y - 1;
            circle.x = 0;
        }
        if (station.scaleX > 1.5) {
            station.scaleX = 1;
            station.scaleY = 1;
            station.y = circle.y - 25;
        }
    }
    var temp;
    var nodes = [];
    function exhale() {
        // Add a new node to the station.
        temp = new createjs.Shape();
        temp.graphics.beginFill("Red")
            .drawCircle(0, 
            0, 
            5
        );
        temp.x = station.x + .1;
        temp.y = Math.floor(stage.canvas.width / 3);
        stage.addChild(temp);
        return temp;
    }

    // Update view
    function update(event) {
        circle.x = circle.x + 15;
        circle.y = circle.y + 0;

        // Fill the station
        fillStation();

        if (nodes.length < 5) {
            nodes.push(exhale());            
        }

        if (nodes) {

            node.x = node.x + 50;

            if (node.x > stage.canvas.width) {
                stage.removeChild(node);
            }
        }
        stage.update(event); // important
    }
</script>
<div>
    <button onclick="init();">Begin Game</button>
    <button onclick="pause();">Pause</button>
    <canvas id='demoCanvas', width=800 height=560 style="border: solid 1px;">
    </canvas>

</div>
{% endblock %}